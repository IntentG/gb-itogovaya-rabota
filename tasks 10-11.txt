USE human_friends;

TRUNCATE TABLE camel;

RENAME TABLE horse TO horse_and_donkey;

INSERT INTO human_friends.horse_and_donkey
SELECT *
FROM human_friends.donkey;

DROP TABLE donkey;


CREATE TABLE young_animals (
	id INT PRIMARY KEY,
	birth_date DATE NOT NULL,
    comands TEXT(500) NOT NULL,
    name VARCHAR(20) NOT NULL,
	vid VARCHAR(20) NOT NULL,
	type VARCHAR(20) NOT NULL
);

DELIMITER $$
CREATE FUNCTION age(birth_date DATE)
    RETURNS INT
    DETERMINISTIC
BEGIN
    DECLARE res INT DEFAULT 0;
    SET res = TIMESTAMPDIFF(MONTH, birth_date, CURDATE());
    RETURN res;
END $$
DELIMITER ;

INSERT INTO human_friends.young_animals
SELECT *
FROM cat WHERE age(birth_date) BETWEEN 12 AND 35;

